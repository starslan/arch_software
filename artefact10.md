# Анализ и описание архитектурных опций и обоснование выбора.


### Критерии выбора
- **Масштабируемость**: Возможность роста нагрузки
- **Сложность**: Ресурсы на внедрение
- **Стоимость владения**: Инфраструктура + поддержка
- **Безопасность**: Защита данных
- **Производительность**: Скорость обработки

### Выбор БД для User Service
| Критерий       | PostgreSQL       | MongoDB          | DynamoDB             | **Выбор**     |
|----------------|------------------|------------------|----------------------|---------------|
| Масштабируемость | Шардирование    | Горизонтальное   | Автомасштабирование  | **PostgreSQL**|
| Транзакции     | ACID             | Документные      | Ограниченная         | **PostgreSQL**|
| Стоимость      | Средняя         | Средняя          | Дорого (pay-per-req) | **PostgreSQL**|

**Обоснование**: Требования к транзакциям и согласованности данных.

### Выбор API Gateway
| Критерий       | Kong             | AWS API Gateway  | Nginx          | **Выбор** |
|----------------|------------------|------------------|----------------|-----------|
| Гибкость       | Плагины (Lua/Go)| Только AWS       | Базовые функции| **Kong**  |
| Производит.    | 50K RPS          | 10K RPS (дорого) | 100K RPS       | **Kong**  |
| Безопасность   | JWT/OAuth2       | IAM              | Нет встроенной | **Kong**  |

**Обоснование**: Open-source решение с балансом цены и возможностей.

### Выбор обработчика событий
| Критерий       | Apache Kafka     | RabbitMQ         | **Выбор**      |
|----------------|------------------|------------------|----------------|
| Производит.    | 1M сообщ/сек     | 50K сообщ/сек    | **Kafka**      |
| Стоимость      | Свои серверы     | Дешевле          | **Kafka**      |
| Надежность     | Репликации       | Средняя          | **Kafka**      |

**Обоснование**: Требования к масштабируемости и имеющийся опыт.

### Выбор хранилища файлов
| Критерий       | MinIO            | AWS S3           | **Выбор**      |
|----------------|------------------|------------------|----------------|
| Стоимость      | Бесплатно (OSS)  | $0.023/GB/мес    | **MinIO**      |
| Производит.    | До 10K RPS       | До 5K RPS        | **MinIO**      |
| Интеграция     | S3-совместимый   | Нативный SDK     | **MinIO**      |
| Масштабируемость| Ручное шардир.  | Автоматическое   | **AWS S3**     |

**Итог**: **MinIO** для экономии (используются собственные серверы)